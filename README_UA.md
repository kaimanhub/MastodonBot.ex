# MastodonBotEx

English documentation is here [README](README.md).

**MastodonBotEx** — це бот на основі Elixir для взаємодії з API Mastodon. Цей проект забезпечує клієнт для стрімінгу та набір утиліт для обробки сповіщень, парсингу даних та публікації статусів на Mastodon.

## Зміст

- [Вступ](#вступ)
- [Особливості](#особливості)
- [Встановлення](#встановлення)
- [Конфігурація](#конфігурація)
- [Використання](#використання)
  - [Клієнт для стрімінгу](#клієнт-для-стрімінгу)
  - [Обробник сповіщень](#обробник-сповіщень)
  - [Спостерігач Репозиторіїв](#cпостерігач-репозиторіїв)
- [Співпраця](#співпраця)
- [Ліцензія](#ліцензія)

## Вступ

MastodonBotEx розроблений для спрощення процесу взаємодії з API Mastodon. Він надає інструменти для легкого стрімінгу сповіщень, парсингу контенту та автоматизації дій, таких як закриття сповіщень або публікація статусів. Незалежно від того, чи ви створюєте простого бота, чи складний додаток, MastodonBotEx стане корисною основою.

## Особливості

- **Клієнт для стрімінгу:** Стрімінг сповіщень користувача в реальному часі за допомогою Tesla та Finch.
- **Парсинг сповіщень:** Витягування деталей зі сповіщень, включаючи інформацію про відправника та вміст повідомлення.
- **Автоматизовані дії:** Закриття сповіщень і публікація відповідей на основі отриманих даних.
- **Конфігурація:** Легко налаштовується за допомогою змінних середовища.

## Встановлення

Щоб додати MastodonBotEx до свого проекту, додайте його до залежностей у `mix.exs`:

```elixir
defp deps do
  [
    {:mastodon_bot_ex, "~> 1.1.0"}
  ]
end
```

Потім виконайте:

```sh
mix deps.get
```

Як опція щоб запустити процес, виконайтеЖ

```sh
iex -S mix 
```

## Конфігурація

Перед використанням MastodonBotEx необхідно налаштувати його для вашого домену Mastodon та токену доступу. Зазвичай це робиться за допомогою змінних середовища.

### Змінні середовища

Створіть файл `.env` у кореневому каталозі вашого проекту та додайте наступне:

```dotenv
MASTODON_DOMAIN=your.mastodon.instance
MASTODON_ACCESS_TOKEN=your_access_token
```

### Конфігурація Elixir

Переконайтеся, що ці змінні середовища завантажені та використовуються у вашій конфігурації. Це можна зробити у вашому `config.exs`:

```elixir
import Config
Dotenv.load!()

config :mastodon_bot_ex,
  domain: System.fetch_env!("MASTODON_DOMAIN"),
  token: System.fetch_env!("MASTODON_ACCESS_TOKEN")
```

## Використання

### Клієнт для стрімінгу

Модуль `MastodonBotEx.StreamingClient` надає функцію для стрімінгу сповіщень користувача. Ця функція використовує Tesla та Finch для підключення до API стрімінгу Mastodon.

Приклад:

```elixir
MastodonBotEx.StreamingClient.stream_user_notifications()
```

Ця функція починає стрімінг сповіщень та обробляє їх відповідно до вашої конфігурації.

### Обробник сповіщень

Модуль `MastodonBotEx.StreamingHandler` обробляє рядки, отримані зі стріму. Він розрізняє дані, сигнали "heartbeat" та невідомі дані, і відповідним чином їх обробляє.

Приклад:

```elixir
line = "data: {\"id\":\"123\", \"account\": {\"id\": \"456\", \"acct\": \"user\"}, \"status\": {\"id\": \"789\", \"content\": \"Hello!\"}}"
MastodonBotEx.StreamingHandler.process_line(line, "your_account_id")
```

### Спостерігач Репозиторіїв

Для детальнішого використання функціональності Спостерігача Репозиторіїв, будь ласка читайте [Документація для Спостерігача Репозиторіїв](REPO_WATCHER_UA.md).

### Парсер сповіщень

Модуль `MastodonBotEx.NotificationParser` витягує відповідні деталі зі сповіщень, такі як ID відправника, ім'я, ID каналу та вміст повідомлення.

Приклад:

```elixir
data = %{"account" => %{"id" => "456", "acct" => "user"}, "status" => %{"id" => "789", "content" => "Hello!"}, "id" => "123"}
details = MastodonBotEx.NotificationParser.extract_message_details(data)
IO.inspect(details)
```

## Співпраця

Ми вітаємо внески до MastodonBotEx! Щоб підтримувати чіткий та організований процес розробки, ми просимо, щоб кожен pull request (PR) був пов'язаний з існуючим issue або запитом на вдосконалення.

### Як внести свій внесок

1. **Перевірте існуючі Issue:** Перед початком роботи перевірте розділ [Issues](https://github.com/kaimanhub/MastodonBot.ex/issues), щоб дізнатися, чи вже обговорюється ваше вдосконалення або виправлення помилки.
2. **Створіть Issue:** Якщо ваша ідея для внеску не охоплена, створіть нове issue або запит на вдосконалення.
3. **Форкуйте репозиторій:** Після створення issue зробіть форк репозиторію.
4. **Створіть нову гілку:** Створіть гілку з описовою назвою (`git checkout -b issue-123-feature-branch`), де `issue-123` відповідає номеру issue.
5. **Внесіть свої зміни:** Зробіть коміт з чіткими та зрозумілими повідомленнями (`git commit -am 'Issue #123: Add new feature'`).
6. **Запуште гілку:** Запуште гілку у ваш форк (`git push origin issue-123-feature-branch`).
7. **Подайте pull request:** Відкрийте pull request, зв'язавши його з issue, яке він вирішує.

Переконайтеся, що ваш код відповідає існуючому стилю та що всі тести пройшли перед поданням PR.

## Ліцензія

Цей проект ліцензований за ліцензією Apache License v2.0. Детальніше дивіться у файлі [LICENSE](LICENSE).
